<html><head><title>Not bullethell (or is it?)</title></head><body><canvas id='cvs'></canvas><p id='info'></p><h1 style='color:red' hidden>You loser</h1><script>const cvs=document.getElementById('cvs');const ctx=cvs.getContext('2d');cvs.width=600;cvs.height=600;cvs.style.border='1px solid black';let loopContinue=true;function collide(obj1,obj2) {return Math.hypot(Math.abs(obj1.x-obj2.x),Math.abs(obj1.y-obj2.y))<obj1.r+obj2.r};let health=100;class Player {constructor(x,y){this.x=x;this.y=y;this.c='black';this.r=20;this.damage=20;};draw(){ctx.fillStyle=this.c;ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,2*Math.PI);ctx.fill();ctx.closePath();};shoot(x,y) {let dir=Math.atan2(y-this.y,x-this.x);bullets.push(new Bullet(this.x,this.y,Math.cos(dir)*5,Math.sin(dir)*5))}};class NormalEnemy {constructor(x,y) {this.x=x;this.y=y;this.r=15;this.c='blue';this.dx=0;this.dy=0;this.shouldDelete=false;this.damage=10;this.health=60;};draw(){ctx.beginPath();ctx.fillStyle=this.c;ctx.arc(this.x,this.y,this.r,0,2*Math.PI);ctx.fill();ctx.closePath();};getDirection() {let dir=Math.atan2(player.y-this.y,player.x-this.x);this.dx=Math.cos(dir)*3;this.dy=Math.sin(dir)*3};update() {if (collide(this,player)) {this.shouldDelete=true;health-=this.damage;if(health<=0){lose()}};this.getDirection();this.x+=this.dx;this.y+=this.dy;}};class Bullet {constructor(x,y,dx,dy) {this.x=x;this.y=y;this.dx=dx;this.dy=dy;this.r=5;this.c='green';this.shouldDelete=false;};draw() {ctx.fillStyle=this.c;ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,2*Math.PI);ctx.fill();ctx.closePath();};update() {enemies.forEach(x=>{if (collide(this,x)){this.shouldDelete=true;x.health-=player.damage;if(x.health<=0){x.shouldDelete=true;if (x.die) x.die();}}});this.x+=this.dx;this.y+=this.dy}};class ShooterEnemy {constructor(x,y){this.x=x;this.y=y;this.c='lime';this.r=15;this.shouldDelete=false;this.health=40;this.arrived=false;this.setShoot=false;this.damage=5;this.decideDest()};draw(){ctx.beginPath();ctx.fillStyle=this.c;ctx.arc(this.x,this.y,this.r,0,2*Math.PI);ctx.fill();ctx.closePath();};decideDest(){this.destX=Math.round(Math.random()*570+15);this.destY=Math.round(Math.random()*570+15);};decideDir(){this.dir=Math.atan2(this.destY-this.y,this.destX-this.x);this.dx=Math.cos(this.dir)*3;this.dy=Math.sin(this.dir)*3};update(){this.decideDir();if (!(Math.abs(this.x-this.destX)<3&&Math.abs(this.y!=this.destY)<3)&&!this.arrived){this.x+=this.dx;this.y+=this.dy;}else if(!this.setShoot){this.arrived=true;this.shootId=setInterval(()=>{this.shoot();},4000);this.setShoot=true;};};shoot(){let dir=Math.atan2(player.y-this.y,player.x-this.x);hostileBullets.push(new HostileBullet(this.x,this.y,Math.cos(dir)*4,Math.sin(dir)*4,this.damage))};die(){clearInterval(this.shootId)}};class HostileBullet{constructor(x,y,dx,dy,dmg){this.x=x;this.y=y;this.dx=dx;this.dy=dy;this.r=5;this.c='orange';this.shouldDelete=false;this.damage=dmg;};draw(){ctx.fillStyle=this.c;ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,2*Math.PI);ctx.fill();ctx.closePath();};update(){this.x+=this.dx;this.y+=this.dy;if (collide(player,this)){health-=this.damage;this.shouldDelete=true;if (health<=0) {lose()}}}};const player=new Player(100,100);player.draw();let enemies=[];let bullets=[];let hostileBullets=[];function lose() {cvs.hidden=true;loopContinue=false;document.getElementById('info').hidden=true;document.querySelector('h1').hidden=false};let keyMap={};function checkKeys() {if (keyMap.a) {if (player.x>player.r) player.x-=3;}if (keyMap.d){if (player.x<600-player.r) player.x+=3};if(keyMap.w){if (player.y>player.r) player.y-=3;}if(keyMap.s){if (player.y<600-player.r) player.y+=3}};function loop(){if (loopContinue) {requestAnimationFrame(loop)};ctx.clearRect(0,0,600,600);bullets=bullets.filter(x=>!x.shouldDelete);enemies=enemies.filter(x=>!x.shouldDelete);hostileBullets=hostileBullets.filter(x=>!x.shouldDelete);player.draw();enemies.forEach(x=>{x.update();x.draw();});bullets.forEach(x=>{x.draw();x.update();});hostileBullets.forEach(x=>{x.draw();x.update();});document.getElementById('info').innerHTML=`health: ${health}`;checkKeys();};loop();document.addEventListener('keydown',(e)=>{keyMap[e.key]=true;});document.addEventListener('keyup',(e)=>{keyMap[e.key]=false});cvs.addEventListener('mousedown',(e)=>{let x=e.clientX-cvs.getBoundingClientRect().left;let y=e.clientY-cvs.getBoundingClientRect().top;player.shoot(x,y)});setInterval(()=>{let x=0;let y=0;if(Math.random()<0.5){x=(Math.random()<0.5)?-15:615;y=Math.random()*570+15}else{y=(Math.random()<0.5)?-15:615;x=Math.random()*570+15};let rand=Math.round(Math.random());if(rand==0){enemies.push(new NormalEnemy(x,y))}else if(rand==1) {enemies.push(new ShooterEnemy(x,y))}},(Math.random()+2)*1000)</script></body></html>